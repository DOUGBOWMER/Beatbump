import{S as ge,i as me,T as ye,k as S,a as x,w as he,q as O,l as k,m as A,c as H,h as m,x as fe,r as Q,n as u,$ as ee,G,b as W,I as v,y as pe,L as B,W as Ie,f as j,g as ve,t as z,d as we,u as K,z as _e,D as Se,V as te,A as ke,a1 as be,e as se,_ as ie,M as Ae}from"./index-02d4e276.js";import{g as M}from"./navigation-8392efd7.js";import{L as Te}from"./Loading-e098347c.js";import{l as P,o as E,n as ae,k as J,r as Ee,L as Pe}from"./window-3d9785aa.js";import{I as Ne}from"./buffer-8e6379eb.js";import{b as Ce,s as Le,P as Re}from"./PopperButton-1074cc5a.js";import"./Icon-33dd6fee.js";import{S as Ge}from"./url-fcaf9571.js";const Me=(e,t)=>{e.includes("ARTIST")?M(`/artist/${t}`):e.includes("PLAYLIST")?M("/playlist/"+t):M("/release?type="+encodeURIComponent(e)+"&id="+encodeURIComponent(t))};async function Ze({item:e,index:t,isBrowseEndpoint:l,type:s,kind:i}){var o,a,n,w,h,f,g;return s==="trending"&&((a=(o=e.endpoint)==null?void 0:o.pageType)!=null&&a.match(/ALBUM|SINGLE/m)?M("/release?type="+encodeURIComponent((n=e==null?void 0:e.endpoint)==null?void 0:n.pageType)+"&id="+encodeURIComponent((w=e.endpoint)==null?void 0:w.browseId)):(await P.initAutoMixSession({videoId:e.videoId,playlistId:e.playlistId,loggingContext:(e==null?void 0:e.loggingContext)||null,keyId:i==="isPlaylist"?t:0,config:{type:e==null?void 0:e.musicVideoType}}),P.updatePosition(i==="isPlaylist"?t:0))),(h=e==null?void 0:e.endpoint)!=null&&h.pageType.includes("ARTIST")&&M(`/artist/${(f=e==null?void 0:e.endpoint)==null?void 0:f.browseId}`),!l&&e.videoId!==void 0&&!((g=e==null?void 0:e.endpoint)!=null&&g.pageType.includes("ARTIST"))?await P.initAutoMixSession({loggingContext:e==null?void 0:e.loggingContext,videoId:e.videoId,playlistId:e.playlistId,keyId:s!=="home"?t:void 0}):Me(e.endpoint.pageType,e.endpoint.browseId),!1}function le({origin:e,title:t,type:l=null,id:s}){switch(l){case"MUSIC_PAGE_TYPE_ALBUM":return{url:`${e}/release?id=${s}`,title:t};case"MUSIC_PAGE_TYPE_ARTIST":return{title:t,url:`${e}/artist/${s}`};case"MUSIC_PAGE_TYPE_PLAYLIST":return{title:t,url:`${e}/playlist/${s}`};case"SESSION":return{title:t,url:`${e}/session?token=${s}`};default:return{url:`${e}/listen?id=${s}`,title:t}}}function ne(e,t,l){const s=e.slice();return s[20]=t[l],s}function re(e){let t,l;return t=new Te({}),{c(){he(t.$$.fragment)},l(s){fe(t.$$.fragment,s)},m(s,i){pe(t,s,i),l=!0},i(s){l||(j(t.$$.fragment,s),l=!0)},o(s){z(t.$$.fragment,s),l=!1},d(s){_e(t,s)}}}function oe(e){let t,l=e[1].subtitle,s=[];for(let i=0;i<l.length;i+=1)s[i]=ce(ne(e,l,i));return{c(){t=S("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){t=k(i,"DIV",{class:!0});var o=A(t);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){u(t,"class","subtitles secondary svelte-kk8ud6")},m(i,o){W(i,t,o);for(let a=0;a<s.length;a+=1)s[a].m(t,null)},p(i,o){if(o&2){l=i[1].subtitle;let a;for(a=0;a<l.length;a+=1){const n=ne(i,l,a);s[a]?s[a].p(n,o):(s[a]=ce(n),s[a].c(),s[a].m(t,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=l.length}},d(i){i&&m(t),be(s,i)}}}function Be(e){let t,l,s=e[20].text+"",i,o,a,n;function w(){return e[15](e[20])}return{c(){t=S("a"),l=S("span"),i=O(s),this.h()},l(h){t=k(h,"A",{href:!0,class:!0});var f=A(t);l=k(f,"SPAN",{class:!0});var g=A(l);i=Q(g,s),g.forEach(m),f.forEach(m),this.h()},h(){var h;u(l,"class","svelte-kk8ud6"),u(t,"href",o="/artist/"+((h=e[20])==null?void 0:h.browseId)),u(t,"class","svelte-kk8ud6")},m(h,f){W(h,t,f),v(t,l),v(l,i),a||(n=B(t,"click",Ie(Ae(w))),a=!0)},p(h,f){var g;e=h,f&2&&s!==(s=e[20].text+"")&&K(i,s),f&2&&o!==(o="/artist/"+((g=e[20])==null?void 0:g.browseId))&&u(t,"href",o)},d(h){h&&m(t),a=!1,n()}}}function De(e){let t,l=e[20].text+"",s;return{c(){t=S("span"),s=O(l),this.h()},l(i){t=k(i,"SPAN",{class:!0});var o=A(t);s=Q(o,l),o.forEach(m),this.h()},h(){u(t,"class","svelte-kk8ud6")},m(i,o){W(i,t,o),v(t,s)},p(i,o){o&2&&l!==(l=i[20].text+"")&&K(s,l)},d(i){i&&m(t)}}}function ce(e){let t;function l(o,a){var n;return(n=o[20])!=null&&n.browseId?Be:De}let s=l(e),i=s(e);return{c(){i.c(),t=se()},l(o){i.l(o),t=se()},m(o,a){i.m(o,a),W(o,t,a)},p(o,a){s===(s=l(o))&&i?i.p(o,a):(i.d(1),i=s(o),i&&(i.c(),i.m(t.parentNode,t)))},d(o){i.d(o),o&&m(t)}}}function Ve(e){let t,l,s,i,o,a,n,w,h,f,g,C,L,T,b,_,N,R=e[1].title+"",Z,D,y,V,r,d=e[7]&&re();T=new Ce({props:{tabindex:0,items:e[5]}});let p=e[1].subtitle&&oe(e);return{c(){t=S("article"),l=S("section"),s=S("section"),i=S("div"),d&&d.c(),o=x(),a=S("img"),C=x(),L=S("div"),he(T.$$.fragment),b=x(),_=S("div"),N=S("span"),Z=O(R),D=x(),p&&p.c(),this.h()},l(c){t=k(c,"ARTICLE",{class:!0});var I=A(t);l=k(I,"SECTION",{class:!0});var X=A(l);s=k(X,"SECTION",{class:!0});var F=A(s);i=k(F,"DIV",{class:!0,tabindex:!0});var U=A(i);d&&d.l(U),o=H(U),a=k(U,"IMG",{alt:!0,loading:!0,width:!0,height:!0,src:!0,"data-src":!0,class:!0}),U.forEach(m),C=H(F),L=k(F,"DIV",{class:!0});var q=A(L);fe(T.$$.fragment,q),q.forEach(m),F.forEach(m),X.forEach(m),b=H(I),_=k(I,"DIV",{class:!0});var Y=A(_);N=k(Y,"SPAN",{class:!0});var $=A(N);Z=Q($,R),$.forEach(m),D=H(Y),p&&p.l(Y),Y.forEach(m),I.forEach(m),this.h()},h(){u(a,"alt","thumbnail img"+e[9]),u(a,"loading",n=e[0]>=3?"lazy":null),u(a,"width",w=e[6].width),u(a,"height",h=e[6].height),ee(a.src,f=e[0]>=3?e[6].placeholder:e[6].url)||u(a,"src",f),u(a,"data-src",g=e[0]>=3?e[6].url:null),u(a,"class","svelte-kk8ud6"),u(i,"class","image img"+e[9]+" svelte-kk8ud6"),u(i,"tabindex","0"),G(i,"active",e[10]),G(i,"isArtistKind",e[8]),u(L,"class","item-menu svelte-kk8ud6"),u(s,"class","item-thumbnail img"+e[9]+" svelte-kk8ud6"),G(s,"isArtistKind",e[8]),u(l,"class","item-thumbnail-wrapper img"+e[9]+" svelte-kk8ud6"),u(N,"class","h1 link svelte-kk8ud6"),u(_,"class","item-title svelte-kk8ud6"),G(_,"isArtistKind",e[8]),u(t,"class","item item"+e[9]+" svelte-kk8ud6")},m(c,I){W(c,t,I),v(t,l),v(l,s),v(s,i),d&&d.m(i,null),v(i,o),v(i,a),v(s,C),v(s,L),pe(T,L,null),v(t,b),v(t,_),v(_,N),v(N,Z),v(_,D),p&&p.m(_,null),y=!0,V||(r=[B(a,"error",je),B(s,"focus",e[13]),B(s,"blur",e[14]),B(t,"contextmenu",e[16]),B(t,"click",Ie(e[17]))],V=!0)},p(c,[I]){c[7]?d?I&128&&j(d,1):(d=re(),d.c(),j(d,1),d.m(i,o)):d&&(ve(),z(d,1,1,()=>{d=null}),we()),(!y||I&1&&n!==(n=c[0]>=3?"lazy":null))&&u(a,"loading",n),(!y||I&64&&w!==(w=c[6].width))&&u(a,"width",w),(!y||I&64&&h!==(h=c[6].height))&&u(a,"height",h),(!y||I&65&&!ee(a.src,f=c[0]>=3?c[6].placeholder:c[6].url))&&u(a,"src",f),(!y||I&65&&g!==(g=c[0]>=3?c[6].url:null))&&u(a,"data-src",g),(!y||I&256)&&G(i,"isArtistKind",c[8]);const X={};I&32&&(X.items=c[5]),T.$set(X),(!y||I&256)&&G(s,"isArtistKind",c[8]),(!y||I&2)&&R!==(R=c[1].title+"")&&K(Z,R),c[1].subtitle?p?p.p(c,I):(p=oe(c),p.c(),p.m(_,null)):p&&(p.d(1),p=null),(!y||I&256)&&G(_,"isArtistKind",c[8])},i(c){y||(j(d),j(T.$$.fragment,c),y=!0)},o(c){z(d),z(T.$$.fragment,c),y=!1},d(c){c&&m(t),d&&d.d(),_e(T),p&&p.d(),V=!1,Se(r)}}}const de=/PLAYLIST|ALBUM|SINGLE/,Xe=/=w\d+-h\d+-/gm,je=e=>{e.currentTarget.onerror=null,e.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJpc29sYXRpb246aXNvbGF0ZSIgdmlld0JveD0iMCAwIDI1NiAyNTYiIHdpZHRoPSIyNTZwdCIgaGVpZ2h0PSIyNTZwdCI+PGRlZnM+PGNsaXBQYXRoIGlkPSJwcmVmaXhfX2EiPjxwYXRoIGQ9Ik0wIDBoMjU2djI1NkgweiIvPjwvY2xpcFBhdGg+PC9kZWZzPjxnIGNsaXAtcGF0aD0idXJsKCNwcmVmaXhfX2EpIj48cGF0aCBmaWxsPSIjNDI0MjQyIiBkPSJNMCAwaDI1NnYyNTZIMHoiLz48ZyBjbGlwLXBhdGg9InVybCgjcHJlZml4X19iKSI+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTA1LjU0IDE2Ni43OTQpIiBmb250LWZhbWlseT0ic3lzdGVtLXVpLC1hcHBsZS1zeXN0ZW0sQmxpbmtNYWNTeXN0ZW1Gb250LCZxdW90O1NlZ29lIFVJJnF1b3Q7LFJvYm90byxPeHlnZW4sVWJ1bnR1LENhbnRhcmVsbCwmcXVvdDtPcGVuIFNhbnMmcXVvdDssJnF1b3Q7SGVsdmV0aWNhIE5ldWUmcXVvdDssc2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1zaXplPSIxMDAiIGZpbGw9IiNmYWZhZmEiPj88L3RleHQ+PC9nPjxkZWZzPjxjbGlwUGF0aCBpZD0icHJlZml4X19iIj48cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5MiA1NC44MzkpIiBkPSJNMCAwaDcydjE0Ni4zMjNIMHoiLz48L2NsaXBQYXRoPjwvZGVmcz48L2c+PC9zdmc+"};function We(e,t){e.preventDefault(),window.dispatchEvent(new CustomEvent("contextmenu",{detail:"carouselItem"})),Re.set({items:t,x:e.pageX,y:e.pageY,direction:"normal"})}const Fe=["Favorite","Add to Queue","View Artist"],ue=["Favorite","Play Next","View Artist"];function Ue(e,t,l){let s,i,o;te(e,P,r=>l(12,i=r)),te(e,Ge,r=>l(18,o=r));let{index:a}=t,{item:n}=t,{type:w=""}=t,{kind:h=""}=t,{aspectRatio:f}=t,{isBrowseEndpoint:g=!1}=t,C=!1;const T=!!(f!=null&&f.includes("TWO_LINE_STACK")&&h!=="Fans might also like"||f!=null&&f.includes("16_9"))?"16x9":"1x1";let b=[{text:"View Artist",icon:"artist",action:async()=>{try{const r=n.artistInfo?n.artistInfo.artist[0].browseId:n.subtitle[0].browseId;if(!r)throw new Error(`Expected a valid artistId string, received ${r}`);M(`/artist/${r}`),await ke(),window.scrollTo({behavior:"smooth",top:0,left:0})}catch(r){E(`Error: ${r}`,"error")}}},{text:"Add to Queue",icon:"queue",action:function(){P.setTrackWillPlayNext(n,i.mix.length),E(`${n.title} has been added to your queue!`,"success")}},{text:"Play Next",icon:"queue",action(){P.setTrackWillPlayNext(n,i.position),E(`${n.title} will play next!`,"success")}},{text:"Add to Playlist",icon:"list-plus",action:async()=>{var r;if((r=n.endpoint)!=null&&r.pageType.match(de)){const c=await(await fetch("/api/v1/get_queue.json?playlistId="+n.playlistId)).json();ae.set({state:!0,item:[...c]})}else ae.set({state:!0,item:n})}},{text:"Favorite",icon:"heart",action:()=>{Le.sendMessage("create","favorite",n)}},J.hasActiveSession?{text:"Share Group Session",icon:"share",action:async()=>{const r=le({type:"SESSION",title:`Join ${J.client.displayName}'s AlphaTrack Session`,id:encodeURIComponent(Ne.toBase64(JSON.stringify({clientId:J.client.clientId,displayName:J.client.displayName}))),origin:o});try{navigator.canShare?await navigator.share(r).then(()=>{E("Shared successfully","success")}).catch(d=>{Pe.err(d)}):(await navigator.clipboard.writeText(r.url),E("Link copied successfully","success"))}catch(d){E("Error: "+d,"error")}}}:{text:"Start Group Session",icon:"users",action:async()=>{Ee.set(!0)}},{text:"Share",icon:"share",action:async()=>{var d,p;const r=le({origin:o,id:((d=n.endpoint)==null?void 0:d.browseId)??n.videoId,type:((p=n.endpoint)==null?void 0:p.pageType)??null,title:n.title});try{navigator.canShare?(await navigator.share(r),E("Shared successfully","success")):(await navigator.clipboard.writeText(r.url),E("Link copied successfully","success"))}catch(c){E("Error: "+c,"error")}}}],_=Array.isArray(n==null?void 0:n.thumbnails)?n==null?void 0:n.thumbnails.at(0):{width:0,height:0,url:"",placeholder:""},N;function R(r){ie.call(this,e,r)}function Z(r){ie.call(this,e,r)}const D=r=>{M("/artist/"+(r==null?void 0:r.browseId))},y=r=>We(r,b),V=async r=>{l(7,C=!0),l(7,C=await Ze({isBrowseEndpoint:g,index:a,item:n,kind:h,type:w}))};return e.$$set=r=>{"index"in r&&l(0,a=r.index),"item"in r&&l(1,n=r.item),"type"in r&&l(2,w=r.type),"kind"in r&&l(3,h=r.kind),"aspectRatio"in r&&l(11,f=r.aspectRatio),"isBrowseEndpoint"in r&&l(4,g=r.isBrowseEndpoint)},e.$$.update=()=>{var r,d,p;e.$$.dirty&4134&&((w==="artist"||n.endpoint&&((r=n.endpoint.pageType)!=null&&r.includes("MUSIC_PAGE_TYPE_ARTIST")))&&l(5,b=b.filter(c=>Fe.includes(c.text))),(d=n.endpoint)!=null&&d.pageType&&l(5,b=(p=n==null?void 0:n.endpoint)!=null&&p.pageType.match(de)?[{action:()=>{P.initPlaylistSession({playlistId:n.playlistId,params:"wAEB8gECKAE%3D",index:0})},icon:"shuffle",text:"Shuffle"},{action:()=>{P.setTrackWillPlayNext(n,i.position)},icon:"queue",text:"Play Next"},{action:()=>{P.initPlaylistSession({playlistId:"RDAMPL"+n.playlistId,params:"wAEB8gECeAE%3D",index:0})},icon:"radio",text:"Start Radio"},...b.filter(c=>!ue.includes(c.text))]:b.filter(c=>ue.includes(c.text)))),e.$$.dirty&64&&l(6,_.url=_.width<100?_.url.replace(Xe,"=w240-h240-"):_.url,_),e.$$.dirty&8&&l(8,s=h==="Fans might also like")},[a,n,w,h,g,b,_,C,s,T,N,f,i,R,Z,D,y,V]}class qe extends ge{constructor(t){super(),me(this,t,Ue,Ve,ye,{index:0,item:1,type:2,kind:3,aspectRatio:11,isBrowseEndpoint:4})}}export{qe as C};
